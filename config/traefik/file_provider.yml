http:
  routers:
    universalis-http:
      service: universalis_weighted
      entrypoints: [http]
      middlewares: [https-redirect]
      rule: Host(`universalis.app`) || Host(`staging.universalis.app`)
    universalis-https:
      service: universalis_weighted
      entrypoints: [https]
      tls: {}
      rule: Host(`universalis.app`) || Host(`staging.universalis.app`)
    universalis-gamedata-https:
      service: universalis@docker
      entrypoints: [https]
      middlewares: [api-cache]
      tls: {}
      rule: Host(`universalis.app`) && PathPrefix(`/api/v3/game`)
    universalis-misc-https:
      service: universalis@docker
      entrypoints: [https]
      middlewares: [api-cache]
      tls: {}
      rule: Host(`universalis.app`) && PathPrefix(`/api/v3/misc`)
    universalis-marketable-https:
      service: universalis@docker
      entrypoints: [https]
      middlewares: [api-cache]
      tls: {}
      rule: Host(`universalis.app`) && (Path(`/api/(v2/)?marketable`) || Path(`/api/v3/marketable-items`))
  services:
    universalis_weighted:
      weighted:
        services:
          - name: universalis@docker
            weight: 84
          - name: universalis_canary@docker
            weight: 16
  middlewares:
    https-redirect:
      redirectScheme:
        scheme: https
        permanent: true
    api-cache:
      plugin:
        cache:
          path: /mnt/cache/api
serversTransport:
  forwardingTimeouts:
    responseHeaderTimeout: 5s
tls:
  certificates:
    - certFile: /mnt/certificates/universalis.app.cert
      keyFile: /mnt/certificates/universalis.app.key
